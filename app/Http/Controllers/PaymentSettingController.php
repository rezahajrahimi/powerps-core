<?php
bolt_decrypt( __FILE__ , '7QUaYi'); return 0;
##!!!##Cm5hbWVzcGFjZSBBcHBcSHR0cFxDb250cm9sbGVyczsKCnVzZSBBcHBcSHR0cFxDb250cm9sbGVyc1xIaWRkaWZ5UGFubmVsQ29udHJvbGxlcjsKdXNlIEFwcFxNb2RlbHNcUGF5bWVudFNldHRpbmc7CgpjbGFzcyBQYXltZW50U2V0dGluZ0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgpCiAgICB7CiAgICAgICAgJHRoaXMtPmhpZGRpZnlDdHJsID0gbmV3IEhpZGRpZnlQYW5uZWxDb250cm9sbGVyKCk7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gc2VlZCgpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gLy8gY2hlY2sgcnVuIG9uIGxvY2FsCiAgICAgICAgICAgIC8vIGlmIChlbnYoJ0FQUF9FTlYnKSAhPSAnbG9jYWwnKSB7CiAgICAgICAgICAgIC8vICAgICBcTG9nOjppbmZvKCdQYXltZW50U2V0dGluZyB0YWJsZSBzZWVkaW5nIGZhaWxlZCBiZWNhdXNlIHJ1biBvbiBsb2NhbCcpOwogICAgICAgICAgICAvLyAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAvLyB9CiAgICAgICAgICAgIC8vIHRydW5jYXRlIHRhYmxlCiAgICAgICAgICAgIFBheW1lbnRTZXR0aW5nOjp0cnVuY2F0ZSgpOwogICAgICAgICAgICAvLyBpbnNlcnQgZGF0YQogICAgICAgICAgICAkZGF0YSA9IFsKCiAgICAgICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAgICAgJ2tleScgICAgICAgICA9PiAnc2hldGFiX3ZlcmlmeScsCiAgICAgICAgICAgICAgICAgICAgJ3ZhbHVlJyAgICAgICA9PiAkdGhpcy0+aGlkZGlmeUN0cmwtPmdlbmVyYXRlVVVJRCgpLAogICAgICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbicgPT4gIjYxMDQzMzMzMzMzMzMzMzMiLAogICAgICAgICAgICAgICAgICAgICdzdGF0dXMnICAgICAgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAgICAgJ2tleScgICAgICAgICA9PiAndXNkX3RyYW5zYWN0aW9uJywKICAgICAgICAgICAgICAgICAgICAndmFsdWUnICAgICAgID0+ICcwJywKICAgICAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nID0+ICcwJywKICAgICAgICAgICAgICAgICAgICAnc3RhdHVzJyAgICAgID0+IHRydWUsCiAgICAgICAgICAgICAgICBdLAoKICAgICAgICAgICAgXTsKICAgICAgICAgICAgUGF5bWVudFNldHRpbmc6Omluc2VydCgkZGF0YSk7CiAgICAgICAgICAgIFxMb2c6OmluZm8oJ1BheW1lbnRTZXR0aW5nIHRhYmxlIHNlZWRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBjYXRjaCAoXFRocm93YWJsZSAkdGgpIHsKICAgICAgICAgICAgXExvZzo6aW5mbygiUGF5bWVudFNldHRpbmcgdGFibGUgc2VlZGluZyBmYWlsZWQ6ICR0aCIpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQogICAgcHVibGljIGZ1bmN0aW9uIHJlR2VuZXJhdGVTaGV0YWJWZXJpZnkoKQogICAgewogICAgICAgICRzaGV0YWJWZXJpZnkgPSAkdGhpcy0+Z2V0UGF5bWVudFNldHRpbmdWYWx1ZUJ5S2V5KCdzaGV0YWJfdmVyaWZ5Jyk7CiAgICAgICAgaWYgKCRzaGV0YWJWZXJpZnkpIHsKICAgICAgICAgICAgJHRoaXMtPnNldFBheW1lbnRTZXR0aW5nVmFsdWVCeUtleSgnc2hldGFiX3ZlcmlmeScsICR0aGlzLT5oaWRkaWZ5Q3RybC0+Z2VuZXJhdGVVVUlEKCkpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmdldFBheW1lbnRTZXR0aW5nVmFsdWVCeUtleSgnc2hldGFiX3ZlcmlmeScpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbJ21lc3NhZ2UnID0+ICdTaGV0YWIgdmVyaWZ5IG5vdCBmb3VuZCddLCA1MDApOwogICAgfQogICAgcHVibGljIGZ1bmN0aW9uIGdldFBheW1lbnRTZXR0aW5nQnlLZXkoJGtleSkKICAgIHsKICAgICAgICAkcGF5bWVudFNldHRpbmcgPSBuZXcgUGF5bWVudFNldHRpbmcoKTsKICAgICAgICAkZGF0YSA9ICRwYXltZW50U2V0dGluZy0+Z2V0UGF5bWVudFNldHRpbmdCeUtleSgka2V5KTsKICAgICAgICBpZiAoISRkYXRhKSB7CiAgICAgICAgICAgICR0aGlzLT5zZWVkKCk7CiAgICAgICAgICAgICRkYXRhID0gJHBheW1lbnRTZXR0aW5nLT5nZXRQYXltZW50U2V0dGluZ0J5S2V5KCRrZXkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGRhdGE7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0UGF5bWVudFNldHRpbmdWYWx1ZUJ5S2V5KCRrZXkpCiAgICB7CiAgICAgICAgJHBheW1lbnRTZXR0aW5nID0gbmV3IFBheW1lbnRTZXR0aW5nKCk7CiAgICAgICAgcmV0dXJuICRwYXltZW50U2V0dGluZy0+Z2V0UGF5bWVudFNldHRpbmdWYWx1ZUJ5S2V5KCRrZXkpOwogICAgfQogICAgcHVibGljIGZ1bmN0aW9uIGdldFBheW1lbnRTZXR0aW5nRGVzY3JpcHRpb25CeUtleSgka2V5KQogICAgewogICAgICAgICRwYXltZW50U2V0dGluZyA9IG5ldyBQYXltZW50U2V0dGluZygpOwogICAgICAgICRwYXltZW50U2V0dGluZyA9ICRwYXltZW50U2V0dGluZy0+Z2V0UGF5bWVudFNldHRpbmdEZXNjcmlwdGlvbkJ5S2V5KCRrZXkpOwoKICAgICAgICBpZiAoaXNfYXJyYXkoJHBheW1lbnRTZXR0aW5nKSkgewogICAgICAgICAgICAvLyB1c2UgZm9ybWF0IHRleHQgc2VydmljZQogICAgICAgICAgICAkcGF5bWVudFNldHRpbmcgPSAkdGhpcy0+dGVsZWdyYW1TZXJ2aWNlLT5mb3JtYXRUZXh0KCRwYXltZW50U2V0dGluZyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkcGF5bWVudFNldHRpbmc7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gcmV2ZXJzZVN0YXR1c0J5S2V5KCRrZXkpCiAgICB7CiAgICAgICAgJHBheW1lbnRTZXR0aW5nID0gbmV3IFBheW1lbnRTZXR0aW5nKCk7CiAgICAgICAgcmV0dXJuICRwYXltZW50U2V0dGluZy0+cmV2ZXJzZVN0YXR1c0J5S2V5KCRrZXkpOwogICAgfQogICAgcHVibGljIGZ1bmN0aW9uIHNldFBheW1lbnRTZXR0aW5nVmFsdWVCeUtleSgka2V5LCAkdmFsdWUpCiAgICB7CiAgICAgICAgJHBheW1lbnRTZXR0aW5nID0gbmV3IFBheW1lbnRTZXR0aW5nKCk7CiAgICAgICAgcmV0dXJuICRwYXltZW50U2V0dGluZy0+c2V0UGF5bWVudFNldHRpbmdWYWx1ZUJ5S2V5KCRrZXksICR2YWx1ZSk7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0UGF5bWVudFNldHRpbmdEZXNjcmlwdGlvbkJ5S2V5KCRrZXksICRkZXNjcmlwdGlvbikKICAgIHsKICAgICAgICAkcGF5bWVudFNldHRpbmcgPSAkdGhpcy0+Z2V0UGF5bWVudFNldHRpbmdCeUtleSgka2V5KTsKICAgICAgICAkcGF5bWVudFNldHRpbmctPmRlc2NyaXB0aW9uID0gJGRlc2NyaXB0aW9uOwogICAgICAgICRwYXltZW50U2V0dGluZy0+c2F2ZSgpOwogICAgICAgIHJldHVybiAkcGF5bWVudFNldHRpbmc7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0UGF5bWVudFNldHRpbmdTdGF0dXNCeUtleSgka2V5LCAkc3RhdHVzKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRzdGF0dXMgPSAkc3RhdHVzID09ICd0cnVlJyB8fCAkc3RhdHVzID09IDEgPyB0cnVlIDogZmFsc2U7CiAgICAgICAgICAgICRwYXltZW50U2V0dGluZyA9ICR0aGlzLT5nZXRQYXltZW50U2V0dGluZ0J5S2V5KCRrZXkpOwogICAgICAgICAgICAkcGF5bWVudFNldHRpbmctPnN0YXR1cyA9ICRzdGF0dXM7CiAgICAgICAgICAgICRwYXltZW50U2V0dGluZy0+c2F2ZSgpOwogICAgICAgICAgICByZXR1cm4gJHBheW1lbnRTZXR0aW5nOwogICAgICAgIH0gY2F0Y2ggKFxUaHJvd2FibGUgJHRoKSB7CiAgICAgICAgICAgIFxMb2c6OmluZm8oIlBheW1lbnRTZXR0aW5nIHRhYmxlIHNlZWRpbmcgZmFpbGVkOiAkdGgiKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KICAgIHB1YmxpYyBmdW5jdGlvbiBnZXRQYXltZW50U2V0dGluZ1N0YXR1c0J5S2V5KCRrZXkpCiAgICB7CiAgICAgICAgJHBheW1lbnRTZXR0aW5nID0gJHRoaXMtPmdldFBheW1lbnRTZXR0aW5nQnlLZXkoJGtleSk7CiAgICAgICAgaWYgKCEkcGF5bWVudFNldHRpbmcpIHsKICAgICAgICAgICAgJHRoaXMtPnNlZWQoKTsKICAgICAgICAgICAgJHBheW1lbnRTZXR0aW5nID0gJHRoaXMtPmdldFBheW1lbnRTZXR0aW5nQnlLZXkoJGtleSk7CiAgICAgICAgfQogICAgICAgIGlmICgkcGF5bWVudFNldHRpbmctPnN0YXR1cyA9PSB0cnVlIHx8ICRwYXltZW50U2V0dGluZy0+c3RhdHVzID09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCn0K