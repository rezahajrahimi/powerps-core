<?php
bolt_decrypt( __FILE__ , 'cWu2k4'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXE1vZGVsczsKCnVzZSBJbGx1bWluYXRlXERhdGFiYXNlXEVsb3F1ZW50XEZhY3Rvcmllc1xIYXNGYWN0b3J5Owp1c2UgSWxsdW1pbmF0ZVxEYXRhYmFzZVxFbG9xdWVudFxNb2RlbDsKCmNsYXNzIEN1c3RvbVRleHQgZXh0ZW5kcyBNb2RlbAp7CiAgICB1c2UgSGFzRmFjdG9yeTsKICAgIHByb3RlY3RlZCAkdGFibGUgPSAnY3VzdG9tX3RleHRzJzsKICAgIHByb3RlY3RlZCAkZmlsbGFibGUgPSBbJ2tleScsICdkZWZhdWx0X3RleHQnLCAnY3VzdG9tX3RleHQnXTsKCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0VGV4dCgka2V5LCAkdmFyaWFibGVzID0gW10pCiAgICB7CiAgICAgICAgJHRleHQgPSAkdGhpcy0+d2hlcmUoJ2tleScsICRrZXkpLT5maXJzdCgpLT5jdXN0b21fdGV4dCA/PwogICAgICAgICAgICAgICAgJHRoaXMtPndoZXJlKCdrZXknLCAka2V5KS0+Zmlyc3QoKS0+ZGVmYXVsdF90ZXh0OwoKICAgICAgICByZXR1cm4gJHRoaXMtPnJlcGxhY2VWYXJpYWJsZXMoJHRleHQsICR2YXJpYWJsZXMpOwogICAgfQoKICAgIHByaXZhdGUgZnVuY3Rpb24gcmVwbGFjZVZhcmlhYmxlcygkdGV4dCwgJHZhcmlhYmxlcykKICAgIHsKICAgICAgICBmb3JlYWNoICgkdmFyaWFibGVzIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAgICAgICR0ZXh0ID0gc3RyX3JlcGxhY2UoJ3snIC4gJGtleSAuICd9JywgJHZhbHVlLCAkdGV4dCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkdGV4dDsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0VGV4dCgka2V5LCAkdGV4dCkKICAgIHsKICAgICAgICAkdGhpcy0+d2hlcmUoJ2tleScsICRrZXkpLT51cGRhdGUoWydjdXN0b21fdGV4dCcgPT4gJHRleHRdKTsKICAgIH0KICAgIHB1YmxpYyBmdW5jdGlvbiBnZXREZWZhdWx0VGV4dCgka2V5KQogICAgewogICAgICAgIHJldHVybiAkdGhpcy0+d2hlcmUoJ2tleScsICRrZXkpLT5maXJzdCgpLT5kZWZhdWx0X3RleHQ7CiAgICB9Cgp9Cg==